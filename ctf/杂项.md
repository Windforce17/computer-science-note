# 综述
杂项是CTF中最好玩的一个方向
如何做好杂项题目：
细心、套路、发散性思维
基础：linux使用、Windows使用、计算机基础
## 内容
除了逆向、pwn、web都算misc
包含：编码、密码、取证、信息隐藏技术、流量分析、磁盘分析、社会工程学...
流量分析：网络、蓝牙、USB、投影仪等。
编码、密码学：对称加密，替换加密。用词频和统计学特征攻击。
取证：硬盘、内存等dump文件分析
信息隐藏：图片、压缩包、视频、文档分析。

# 基本编码技术

## 摩尔斯电码
![[Pasted image 20220711163329.png]]
## 题目
```c
.. -.-. .... ..- -. --.- .. ..- -- --- .-. ... . - . ... -
```
解密后得：ICHUNQIUMORSETEST
## 敲击码
敲击码（Tap code）是一种以非常简单的方式对文本信息进行编码的方法。因该编码对信息通过使用一系列的点击声音来编码而命名，敲击码是基于 5 ×5 方格波利比奥斯方阵来实现的，不同点是是用 K 字母被整合到 C 中。
![[敲击码.png]]
## 曼彻斯特编码

在电信与数据存储中, 曼彻斯特编码（Manchester coding），又称自同步码、相位编码（phase encoding，PE），能够用信号的变化来保持发送设备和接收设备之间的同步。它用电压的变化来分辨0和1，从高电平到低电平的跳变代表1，而从低电平到高电平的跳变代表0
![[曼彻斯特编码.png]]
![[Pasted image 20220713152424.png]]
总结：

每个比特发送时间恒定（“周期”）。
0用低至高转换表示，1用高到低转换表示（根据G.E. Thomas方式—IEEE 802.3方式与之相反）
表示0或1的转换出现在周期的中点。
周期开始的转换不表示数据。
## 二进制编码
将 ascii 码对应的数字换成二进制表示形式。

-   只有 0 和 1
-   不大于 8 位，一般 7 位也可以，因为可见字符到 127。
## 16进制编码  
将 ascii 码对应的数字换成十六进制表示形式。

A~Z→0x41~0x5A
a~z→0x61~0x7A



## 字母表编码
A-Z/a-z 对应 1-26 或者 0-25
### 题目
2018 DEFCON Quals ghettohackers: Throwback
把源字符串按照 ! 分割，然后字符串长度 1 对应字母 a，长度 2 对应字母 b
```python
ori = 'Anyo!e!howouldsacrificepo!icyforexecu!!onspeedthink!securityisacomm!ditytop!urintoasy!tem!'
sp = ori.split('!')
print(repr(''.join(chr(97 + len(s) - 1) for s in sp)))
```
## ASCII编码
![[ACII编码.png]]

## base系列
base xx 中的 xx 表示的是采用多少个字符进行编码，比如说 base64 就是采用以下 64 个字符编码，由于 2 的 6 次方等于 64，所以每 6 个比特为一个单元，对应某个可打印字符。3 个字节就有 24 个比特，对应于 4 个 Base64 单元，即 3 个字节需要用 4 个可打印字符来表示。它可用来作为电子邮件的传输编码。在 Base64 中的可打印字符包括字母 A-Z、a-z、数字 0-9，这样共有 62 个字符,再加上+/ 共计64位
base系列的编码表不是固定的，如果是换表的base算法，则和对称加密比较相似，密钥就是base编码表
默认的表`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/`
## 霍夫曼编码
是一种压缩算法。
![[霍夫曼.png]]
## XXencoding
最初是用于邮件中的二进制编码
XXencode 将输入文本以每三个字节为单位进行编码。如果最后剩下的资料少于三个字节，不够的部份用零补齐。这三个字节共有 24 个 Bit，以 6bit 为单位分为 4 个组，每个组以十进制来表示所出现的数值只会落在 0 到 63 之间。以所对应值的位置字符代替。
特点 
只有数字，大小写字母
+ 号，- 号。
工具
http://web.chacuo.net/charsetxxencode
## URL编码
有些字符在url格式中有特殊含义，因此在表单提交，url传输时采用html编码。
此外utf8格式也会经过url编码。
标准格式不应该对非保留字符编码。

特点：大量的百分号.
解码：使用escape

## Unicode 编码
有四种形式
```
源文本： The

&#x [Hex]: &#x0054;&#x0068;&#x0065;

&# [Decimal]: &#00084;&#00104;&#00101;

\U [Hex]: \U0054\U0068\U0065

\U+ [Hex]: \U+0054\U+0068\U+0065


```
## HTML实体编码
和url相似，html中有些字符的保留的。
在 HTML 中不能使用小于号（<）和大于号（>），这是因为浏览器会误认为它们是标签。
字符实体类似这样：
&entity_name;
或者
&#entity_number;
如需显示小于号，我们必须这样写：`&lt;` 或 `&#60`;
HTML 中的常用字符实体是不间断空格(`&nbsp;`)。
如果您在文本中写 10 个空格，在显示该页面之前，浏览器会删除它们中的 9 个。如需在页面中增加空格的数量，您需要使用 `&nbsp`; 字符实体。
## 条形码
宽度不等的多个黑条和空白，按照一定的编码规则排列，用以表达一组信息的图形标识符
国际标准
EAN-13 商品标准，13 位数字
Code-39：39 字符
Code-128：128 字符
工具:https://online-barcode-reader.inliteresearch.com/
## 二维码
用某种特定几何图形按一定规律在平面分步的黑白相间的图形记录数据符号信息
堆叠式 / 行排式二维码：Code 16 k、Code 49、PDF417
矩阵式二维码：QR CODE
![[二维码.png]]
•位置探测图形、位置探测图形分隔符、定位图形：用于对二维码的定位，对每个QR码来说，位置都是固定存在的，只是大小规格会有所差异；
•校正图形：规格确定，校正图形的数量和位置也就确定了；
•格式信息：表示改二维码的纠错级别，分为L、M、Q、H，对应7%，15%，25%，30%的容错度。也就是说，如果你在生成二维码时选择H档容错度，即使30%的图案被遮挡，也可以被正确扫描；
•版本信息：即二维码的规格，QR码符号共有40种规格的矩阵（一般为黑白色），从21x21（版本1），到177x177（版本40），每一版本符号比前一版本 每边增加4个模块
•数据和纠错码字：实际保存的二维码信息，和纠错码字（用于修正二维码损坏带来的错误）。
工具：QR_research
### 题目
[[buuoj#N种方法解决]]

## 古典密码
所有古典密码均属于对称加密
### 移位密码
凯撒密码（Caesar）加密时会将明文中的 **每个字母** 都按照其在字母表中的顺序向后（或向前）移动固定数目（**循环移动**）作为密文。例如，当偏移量是左移 3 的时候（解密时的密钥就是 3）：
明文字母表：ABCDEFGHIJKLMNOPQRSTUVWXYZ 
密文字母表：DEFGHIJKLMNOPQRSTUVWXYZABC
移位密码是移动其他数量的位数

### 埃特巴什码（Atbash Cipher)
明文：A B C D E F G H I J K L M N O P Q R S T U V W X Y Z 
密文：Z Y X W V U T S R Q P O N M L K J I H G F E D C B A
明文：the quick brown fox jumps over the lazy dog
密文：gsv jfrxp yildm ulc qfnkh levi gsv ozab wlt

### 简单替换密码
简单替换密码（Simple Substitution Cipher）加密时，将每个明文字母替换为与之唯一对应且不同的字母。它与恺撒密码之间的区别是其密码字母表的字母不是简单的移位，而是完全是混乱的，这也使得其破解难度要高于凯撒密码。 比如：

明文字母 : abcdefghijklmnopqrstuvwxyz 
密钥字母 : phqgiumeaylnofdxjkrcvstzwb

明文：the quick brown fox jumps over the lazy dog
密文：cei jvaql hkdtf udz yvoxr dsik cei npbw gdm

### 仿射密码
根据一个线性方程做代换

### Playfair
密文格式:BM OD ZB XD NA BE KU DM UI XM MO UV IF
### Polybius
### Vigenere 维吉尼亚密码
### Nihilist
### Hill
### AutokeyCipher
### 培根密码
只使用A和B
只有两种字符
每一段的长度为 5
加密内容会有特殊的字体之分，亦或者大小写之分。
### 栅栏密码
### 工具
https://github.com/jameslyons/pycipher

# 音频隐写
与音频相关的 CTF 题目主要使用了隐写的策略，主要分为 MP3 隐写，LSB 隐写，波形隐写，频谱隐写等等。

## 波形与频谱分析
特征：频谱隐写是讲字符串隐藏在频谱中，此类音频通常会有一个较明显的特征，听起来是一段杂音或者比较刺耳。
### 题目
[[buuoj#来首歌吧]]
听一首歌
## 拨号音  
http://dialabc.com/sound/detect/
## 音频LSB隐写
工具slienteye:WAV

https://github.com/achorein/silenteye

png
### 题目
2015 广东省强网杯 - Little Apple



# 视频隐写
目前在CTF赛事中较为常出现的视频隐写，一般都是将一场带有隐写信息的图片，嵌入视频中，我们所需要做的就是将这个图片从视频分离出来，然后在分析我们分离出来的文件是什么，之后的操作可能会涉及到密码编码，图片隐写等知识点。
## MSU StegoVideo 数据隐写
针对avi格式
![[Pasted image 20220714104015.png]]


## TCStego
用于隐藏mp4 和quicktime信息
## Ourstrect
![[ourstrect.png]]
AVI MP4
## 题目
[[buuoj#金三胖]]
[[csaw#watchword]]
[[bctf#catvideo]]

# 文本隐写
## 编码隐写
[[#基本编码技术]]
## 密码隐写
[[#古典密码]]
# word密码破解
john the ripper 配合hashcat

### 题目
[[祥云杯#到点了]]
# 电子文档隐写
## word隐写
Word、Excel、PowerPoint提供了许多在文档中隐藏数据的方法，包括批注、个人信息、水印、不可见内容、隐藏文字和定制的XML数据。最简单，也是最奇妙的，也就是这里将提到的隐藏文本功能。
### 隐藏文字
![[Pasted image 20220713151254.png]]
## xml隐写
word本身就是一个压缩包
我们可以将word文档转换成xml格式，当然反过来我们也可以将xml转换成word文档，这导致了我们如果重新打包为word文档的过程中，有可能被隐藏进其他数据。
![[Pasted image 20220713151501.png]]
除此之外，也可以用strings binwalk等查看
## pdf隐写
[[#wbStego4open]]
# 代码隐写
## pyc隐写
在我们导入 python 脚本时在目录下会生成个一个相应的 pyc 文件，是 pythoncodeobj 的持久化储存形式, 加速下一次的装载。
pyc 文件由三大部分组成
最开始 4 个字节是一个 Maigc int, 标识此 pyc 的版本信息
接下来四个字节还是个 int, 是 pyc 产生的时间
序列化的 PyCodeObject, 结构参照 include/code.h, 序列化方法 python/marshal
工具:pycdc

## js隐写
### JSFuck
```js
false       =>  ![]
true        =>  !![]
undefined   =>  [][[]]
NaN         =>  +[![]]
0           =>  +[]
1           =>  +!+[]
2           =>  !+[]+!+[]
10          =>  [+!+[]]+[+[]]
Array       =>  []
Number      =>  +[]
String      =>  []+[]
Boolean     =>  ![]
Function    =>  []["filter"]
eval        =>  []["filter"]["constructor"]( CODE )()
window      =>  []["filter"]["constructor"]("return this")()
```
```javascript
[][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]][([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[!+[]+!+[]+!+[]]]]+([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]]+([][[]]+[])[+[[+!+[]]]]+(![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[+!+[]]]]+([][[]]+[])[+[[+[]]]]+([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]((![]+[])[+[[+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]+(!![]+[])[+[[+[]]]]+([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[+!+[]]]+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+[+!+[]]+([][(![]+[])[+[[+[]]]]+([][[]]+[])[+[[!+[]+!+[]+!+[]+!+[]+!+[]]]]+(![]+[])[+[[!+[]+!+[]]]]+(!![]+[])[+[[+[]]]]+(!![]+[])[+[[!+[]+!+[]+!+[]]]]+(!![]+[])[+[[+!+[]]]]]+[])[+[[+!+[]]]+[[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]]])()

```
### aaencode
由日本人写的加密算法
```js
ﾟωﾟﾉ= /｀ｍ´）ﾉ ~┻━┻   //*´∇｀*/ ['_']; o=(ﾟｰﾟ)  =_=3; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) =(ﾟΘﾟ)= (o^_^o)/ (o^_^o);(ﾟДﾟ)={ﾟΘﾟ: '_' ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==3) +'_') [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ '_')[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ==3) +'_')[ﾟｰﾟ] }; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==3) +'_') [c^_^o];(ﾟДﾟ) ['c'] = ((ﾟДﾟ)+'_') [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) ['o'] = ((ﾟДﾟ)+'_') [ﾟΘﾟ];(ﾟoﾟ)=(ﾟДﾟ) ['c']+(ﾟДﾟ) ['o']+(ﾟωﾟﾉ +'_')[ﾟΘﾟ]+ ((ﾟωﾟﾉ==3) +'_') [ﾟｰﾟ] + ((ﾟДﾟ) +'_') [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==3) +'_') [ﾟΘﾟ]+((ﾟｰﾟ==3) +'_') [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) ['c']+((ﾟДﾟ)+'_') [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) ['o']+((ﾟｰﾟ==3) +'_') [ﾟΘﾟ];(ﾟДﾟ) ['_'] =(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)=((ﾟｰﾟ==3) +'_') [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+'_') [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==3) +'_') [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ==3) +'_') [ﾟΘﾟ]+ (ﾟωﾟﾉ +'_') [ﾟΘﾟ]; (ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]='\\'; (ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)=(ﾟωﾟﾉ +'_')[c^_^o];(ﾟДﾟ) [ﾟoﾟ]='\"';(ﾟДﾟ) ['_'] ( (ﾟДﾟ) ['_'] (ﾟεﾟ+/*´∇｀*/(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+(ﾟｰﾟ)+(ﾟΘﾟ)+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+((ﾟｰﾟ) + (ﾟΘﾟ))+(ﾟｰﾟ)+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+(ﾟｰﾟ)+((ﾟｰﾟ) + (ﾟΘﾟ))+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+((o^_^o) +(o^_^o))+((o^_^o) - (ﾟΘﾟ))+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+((o^_^o) +(o^_^o))+(ﾟｰﾟ)+(ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+(c^_^o)+(ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+((o^_^o) - (ﾟΘﾟ))+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+(ﾟｰﾟ)+((o^_^o) +(o^_^o))+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+((ﾟｰﾟ) + (ﾟΘﾟ))+(ﾟｰﾟ)+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+(ﾟｰﾟ)+(ﾟΘﾟ)+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+(ﾟｰﾟ)+((ﾟｰﾟ) + (o^_^o))+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+((ﾟｰﾟ) + (o^_^o))+(o^_^o)+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+(ﾟｰﾟ)+(ﾟΘﾟ)+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+(ﾟｰﾟ)+(ﾟΘﾟ)+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+(ﾟｰﾟ)+((ﾟｰﾟ) + (ﾟΘﾟ))+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+((ﾟｰﾟ) + (ﾟΘﾟ))+((o^_^o) +(o^_^o))+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+(ﾟｰﾟ)+(o^_^o)+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+((ﾟｰﾟ) + (ﾟΘﾟ))+((ﾟｰﾟ) + (o^_^o))+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+(ﾟｰﾟ)+(ﾟｰﾟ)+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+(ﾟｰﾟ)+((ﾟｰﾟ) + (ﾟΘﾟ))+(ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+((ﾟｰﾟ) + (o^_^o))+((ﾟｰﾟ) + (ﾟΘﾟ))+(ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+((o^_^o) - (ﾟΘﾟ))+(ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+(ﾟΘﾟ)+(ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) ('_');
```
工具 ：
http://www.atoolbox.net/Tool.php?Id=703
https://utf-8.jp/public/aaencode.html
http://www.hiencode.com/aaencode.html
## brainfuck
```c
++++++++++[>+++++++>++++++++++>+++>+<<<<-]
>++.>+.+++++++..+++.>++.<<+++++++++++++++.
>.+++.------.--------.>+.>.
```

工具：https://github.com/pablojorge/brainfuck

## HTML
snow 隐写
特点：html中插入空格、制表符
https://www.darkside.com.au/snow/
# 取证
工具：
内存取证:[[#volatility3]] [[#AXIOM]]
硬盘硬盘取证：[[#diskgenius]] [[#AXIOM]] [[#autospy]]
## 磁盘镜像取证
常见的磁盘分区格式有以下几种

-   Windows: FAT12 -> FAT16 -> FAT32 -> NTFS
-   Linux: EXT2 -> EXT3 -> EXT4
raw、vmdk、qcow2等
### 磁盘提取
本地磁盘提取：
if of 不能在一个磁盘上
```
fdisk -l    # 查看磁盘及分区
dd if=需要拷贝的磁盘 of=/存储目录/镜像文件 （确保存储目录有足够的空间） # 获取整个磁盘镜像文件
```    
远程：
```
# 取证机器 B 上运行
nc -l -p 4445 | dd of=/tmp/sda2.dd

# 受害机器 A 上执行传输，即可完成从受害机器 A 克隆 sda 硬盘到取证机器 B 的任务：
dd if=/dev/sda2 | nc 192.168.10.11 4445
```
FTK IMager
https://accessdata.com/product-download-page
```
./ftkimager --help          # 查看帮助信息
./ftkimager --list-drives   # 查看当前加载的驱动器列表

# 获取/dev/sdb 这个磁盘的 E01 模式的文件映像
./ftkimager /dev/sdb /tmp/cyq.e01 --e01 --frag 500M --description "cyq" --examiner cyq
    # /dev/sdb              取证目标驱动器名称
    # /tmp/cyq.e01          取证文件的名称和路径
    # --e01                 表示使用 E01 格式。
    # --frag 500M           表示每 500MB 分成一个文件，在映象片断的大小中，用户可以可以选择将映象分割为多个文件以便于在 DVD 或 FAT 文件系统中中备份
    # --examiner cyq        取证操作人员的姓名简称
    # --description "cyq"   操作说明

# dd 镜像格式是目前被最广泛使用的一种镜像格式，也称成原始格式 (RAW Image)。dd 镜像的优点是兼容性强，目前所有磁盘镜像和分析工具都支持 dd 格式。
# E01 是法证分析工具 EnCase 的一个证据文件格式，较好地解决了 dd 镜像的一些不足。在生成 E01 格式证据文件时，会要求用户输入与调查案件相关的信息，如调查人员、地点、机构、备注等元数据。这些元数据将随证据数据信息一同 存入 E01 文件中。文件的每个字节都经过 32 位的 CRC 校验，这就使得证据被篡改的可能性几乎为 0。默认情况下，分析软件自动以每 64 扇区的数据块进行校验，这种方式兼顾速度和完整性两个方面的考虑。获取个磁盘的 E01 模式的文件映像需要一些时间，根据磁盘大小和硬件型号有所差异.
xmount - xmount 工具可以把 E01 格式的镜像文件转化为 VDI 或者 VMDK 格式。然后用户可以使用 VirtualBox 和 Vmware 软件打开文件进行取
```
**xmount** - xmount 工具可以把 E01 格式的镜像文件转化为 VDI 或者 VMDK 格式。然后用户可以使用 VirtualBox 和 Vmware 软件打开文件进行取证操作。


### VMDK
VMDK 文件本质上是物理硬盘的虚拟版，也会存在跟物理硬盘的分区和扇区中类似的填充区域，我们可以利用这些填充区域来把我们需要隐藏的数据隐藏到里面去，这样可以避免隐藏的文件增加了 VMDK 文件的大小（如直接附加到文件后端），也可以避免由于 VMDK 文件大小的改变所带来的可能导致的虚拟机错误。而且 VMDK 文件一般比较大，适合用于隐藏大文件。

EXT系列文件系统的inode恢复、FAT系列文件系统中的FAT表恢复
当对文件的分析遇到瓶颈时，不妨了解文件系统本身的特性，以此来寻找突破口。
NTFS数据流
## Linux 系统取证分析
#todo 
https://san-na.github.io/sec/Linux%E5%8F%96%E8%AF%81%E5%88%86%E6%9E%90/
???
## 数据取证
#todo 
???
## 内存取证
直接dump系统内存，尝尝和磁盘取证结合
工具[[#volatility]]

### 题目
网鼎杯 密码柜
![[Pasted image 20220712101449.png]]
[[护网杯#easp_dump]]


# 常用工具
## vscode
## msvc
https://visualstudio.microsoft.com/downloads/ 
![[Pasted image 20220711161833.png]]
![[Pasted image 20220711161412.png]]
![[Pasted image 20220711161426.png]]
## Python
添加到path
```shell
pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple

```

## 010editor
16进制编辑器
## binwalk
支持递归扫描
## formost
和binwalk相似，根据文件头提取文件
## zsteg
查看png、bmp中可能隐藏的数据，LSB隐写查看等。

## string

`strings -e l xxx.dmp| grep "flag{"`
### 题目
[[buuoj#你竟然赶我走]]

## file
查看文件类型
## qemu-utils
用于转换磁盘格式:
`qemu-img convert`
qemu-img convert -f raw -O qcow2 image.img image.qcow2
qemu-img convert -f vmdk -O raw image.vmdk image.img
qemu-img convert -f vmdk -O qcow2 image.vmdk image.qcow2
## AZPR
zip压缩包破解 
## RAR_Password_unlocker
rar 压缩包破解
## wireshark 
流量分析
## laky
![[Pasted image 20220711163616.png]]
## volatility
### 安装
执行pip3 install -r requirements.txt
![[Pasted image 20220711155746.png]]
执行: `apt search snappy`
```
libsnappy-dev/jammy 1.1.8-1build3 amd64
  fast compression/decompression library (development files)

```
ubuntu: apt install libsnapp-dev
```
pwn@ubuntu:~/shared/hacktools/misc/volatility3% ./vol.py
Volatility 3 Framework 2.3.0
usage: volatility [-h] [-c CONFIG] [--parallelism [{processes,threads,off}]] [-e EXTEND] [-p PLUGIN_DIRS] [-s SYMBOL_DIRS]
                  [-v] [-l LOG] [-o OUTPUT_DIR] [-q] [-r RENDERER] [-f FILE] [--write-config] [--save-config SAVE_CONFIG]
                  [--clear-cache] [--cache-path CACHE_PATH] [--offline] [--single-location SINGLE_LOCATION]
                  [--stackers [STACKERS ...]] [--single-swap-locations [SINGLE_SWAP_LOCATIONS ...]]
                  plugin ...
volatility: error: Please select a plugin to run
```
下载符号表，放在volatility3的symbols目录下，大大提升分析效率
win:downloads.volatilityfoundation.org/volatility3/symbols/windows.zip
mac:downloads.volatilityfoundation.org/volatility3/symbols/mac.zip
linux: downloads.volatilityfoundation.org/volatility3/symbols/linux.zip
### 常用插件
```
常用插件：
pslist
psscan
filescan
filedump
vadinfo
```
mimikatz插件安装:
```sh
#复制mimikatz.py 到plugins/windows目录
#安装依赖
pip3 install  construct
```
### 使用
查看镜像信息，决定了后面使用的profile
```sh
volatility -f Target.vmem imageinfo
```
查看密码：`volatility -f Target.vmem --profile=Win7SP1x64 hashdump`
带mimikaz可以解密明文：`volatility -f Target.vmem --profile=Win7SP1x64 mimikatz`
注册表：`volatility -f xp.raw --profile=WinXPSP2x86 hivelist`
SAM表用户：`volatility -f xp.raw --profile=WinXPSP2x86 printkey -K "SAM\Domains\Account\Users\Names"`
dump进程：`volatility -f xp.raw --profile=WinXPSP2x86 memdump -p [PID] -D [dump 出的文件保存的目录]`
dump命令行:`volatility -f xp.raw --profile=WinXPSP2x86 cmdscan`

新版本直接使用插件即可:`volatility -f Target.vmem [plugin name]`

### 旧版本
使用docker部署：
docker pull phocean/volatility
```shell
function volatility() {
  docker run --rm --user=$(id -u):$(id -g) -v "$(pwd)":/dumps:ro,Z -ti phocean/volatility $@
}
```
## PTF
专门找密码的软件，和mimikaz相似，针对内存镜像搜索。可以用来搜索bitblocker密钥
安装license:999999999996QMYCNZ7XEJ98S49E3UYGS49E3SWF
## exiftool
元数据分析和改写
sudo apt install libimage-exiftool-perl

## StegHide
隐藏数据到音视频文件里
支持：support for JPEG, BMP, WAV and AU 
## MP3Stego 
MP3隐写主要是使用这个工具完成的。
```py
encode -E hidden_text.txt -P pass svega.wav svega_stego.mp3
decode -X -P pass svega_stego.mp3
```

## foremost 
通过文件头解压文件，和binwalk比较相似

## wbStego4open
pdf txt htm bmp
## AXIOM
速度比较慢，操作简单
![[Screenshot_20220711_170241.png]]
## sleuthkit
https://www.wangan.com/docs/1601
## autospy
sleuthkit的GUI版，分析文件系统，已删除文件等。
![[Screenshot_20220711_170920.png]]